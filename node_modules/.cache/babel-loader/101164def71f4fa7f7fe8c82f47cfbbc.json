{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/Kompa/Desktop/games/my-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/Kompa/Desktop/games/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _classCallCheck from \"C:/Users/Kompa/Desktop/games/my-app/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/Kompa/Desktop/games/my-app/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _slicedToArray from \"C:/Users/Kompa/Desktop/games/my-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _toConsumableArray from \"C:/Users/Kompa/Desktop/games/my-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _createForOfIteratorHelper from \"C:/Users/Kompa/Desktop/games/my-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _ from \"pino\";\nimport j, { PROPOSAL_EXPIRY_MESSAGE as R } from \"@walletconnect/sign-client\";\nimport { isValidObject as L, getSdkError as C, isValidArray as k } from \"@walletconnect/utils\";\nimport { getDefaultLoggerOptions as U } from \"@walletconnect/logger\";\nimport { JsonRpcProvider as c } from \"@walletconnect/jsonrpc-provider\";\nimport d, { HttpConnection as T } from \"@walletconnect/jsonrpc-http-connection\";\nimport F from \"events\";\nvar I = \"error\",\n  M = \"wss://relay.walletconnect.com\",\n  G = \"wc\",\n  z = \"universal_provider\",\n  E = \"\".concat(G, \"@\", 2, \":\").concat(z, \":\"),\n  x = \"https://rpc.walletconnect.com/v1\",\n  o = {\n    DEFAULT_CHAIN_CHANGED: \"default_chain_changed\"\n  };\nvar J = Object.defineProperty,\n  $ = Object.getOwnPropertySymbols,\n  V = Object.prototype.hasOwnProperty,\n  W = Object.prototype.propertyIsEnumerable,\n  H = function H(i, e, t) {\n    return e in i ? J(i, e, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: t\n    }) : i[e] = t;\n  },\n  f = function f(i, e) {\n    for (var t in e || (e = {})) V.call(e, t) && H(i, t, e[t]);\n    if ($) {\n      var _iterator = _createForOfIteratorHelper($(e)),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var t = _step.value;\n          W.call(e, t) && H(i, t, e[t]);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n    return i;\n  };\nfunction a(i, e, t) {\n  var s;\n  var n = g(i);\n  return e.rpcMap && (s = e.rpcMap[n]), s || (s = \"\".concat(x, \"?chainId=eip155:\").concat(n, \"&projectId=\").concat(t)), s;\n}\nfunction g(i) {\n  return i.includes(\"eip155\") ? Number(i.split(\":\")[1]) : Number(i);\n}\nfunction K(i, e) {\n  if (!e.includes(i)) throw new Error(\"Chain '\".concat(i, \"' not approved. Please use one of the following: \").concat(e.toString()));\n}\nfunction X(i) {\n  return i.map(function (e) {\n    return \"\".concat(e.split(\":\")[0], \":\").concat(e.split(\":\")[1]);\n  });\n}\nfunction Y(i, e) {\n  var t = Object.keys(e.namespaces).filter(function (n) {\n    return n.includes(i);\n  });\n  if (!t.length) return [];\n  var s = [];\n  return t.forEach(function (n) {\n    var r = e.namespaces[n].accounts;\n    s.push.apply(s, _toConsumableArray(r));\n  }), s;\n}\nfunction B(i) {\n  var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var t = A(i),\n    s = A(e);\n  return f({}, Object.assign(t, s));\n}\nfunction A(i) {\n  var e, t, s, n;\n  var r = {};\n  if (!L(i)) return r;\n  for (var _i = 0, _Object$entries = Object.entries(i); _i < _Object$entries.length; _i++) {\n    var _Object$entries$_i = _slicedToArray(_Object$entries[_i], 2),\n      v = _Object$entries$_i[0],\n      l = _Object$entries$_i[1];\n    var q = y(v) ? [v] : l.chains,\n      S = l.methods || [],\n      D = l.events || [],\n      p = N(v);\n    r[p] = {\n      chains: P(q, (e = r[p]) == null ? void 0 : e.chains),\n      methods: P(S, (t = r[p]) == null ? void 0 : t.methods),\n      events: P(D, (s = r[p]) == null ? void 0 : s.events),\n      rpcMap: f(f({}, (n = r[p]) == null ? void 0 : n.rpcMap), l.rpcMap)\n    };\n  }\n  return r;\n}\nfunction y(i) {\n  return i.includes(\":\");\n}\nfunction N(i) {\n  return y(i) ? i.split(\":\")[0] : i;\n}\nfunction P() {\n  var i = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  return _toConsumableArray(new Set([].concat(_toConsumableArray(i), _toConsumableArray(e))));\n}\nvar h = function h(i, e) {\n  var t = function t(s) {\n    s.request !== e.request || s.topic !== e.topic || (i.events.removeListener(\"session_request_sent\", t), Q(e));\n  };\n  i.on(\"session_request_sent\", t);\n};\nfunction Q(i) {\n  if (typeof window < \"u\") try {\n    var e = window.localStorage.getItem(\"WALLETCONNECT_DEEPLINK_CHOICE\");\n    if (e) {\n      var t = JSON.parse(e),\n        s = t === null || t === void 0 ? void 0 : t.href;\n      if (typeof s == \"string\") {\n        s.endsWith(\"/\") && s.slice(0, -1);\n        var n = \"\".concat(s, \"/wc?requestId=\").concat(i.id, \"&sessionTopic=\").concat(i.topic);\n        window.open(n, \"_self\", \"noreferrer noopener\");\n      }\n    }\n  } catch (e) {\n    console.error(e);\n  }\n}\nvar Z = /*#__PURE__*/function () {\n  function Z(e) {\n    _classCallCheck(this, Z);\n    this.name = \"eip155\", this.namespace = e.namespace, this.client = e.client, this.events = e.events, this.httpProviders = this.createHttpProviders(), this.chainId = parseInt(this.getDefaultChain());\n  }\n  _createClass(Z, [{\n    key: \"request\",\n    value: function () {\n      var _request = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(e) {\n        var t;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.t0 = e.request.method;\n              _context.next = _context.t0 === \"eth_requestAccounts\" ? 3 : _context.t0 === \"eth_accounts\" ? 4 : _context.t0 === \"wallet_switchEthereumChain\" ? 5 : _context.t0 === \"eth_chainId\" ? 6 : 7;\n              break;\n            case 3:\n              return _context.abrupt(\"return\", this.getAccounts());\n            case 4:\n              return _context.abrupt(\"return\", this.getAccounts());\n            case 5:\n              return _context.abrupt(\"return\", (this.handleSwitchChain(e.request.params ? (t = e.request.params[0]) == null ? void 0 : t.chainId : \"0x0\"), null));\n            case 6:\n              return _context.abrupt(\"return\", parseInt(this.getDefaultChain()));\n            case 7:\n              if (!this.namespace.methods.includes(e.request.method)) {\n                _context.next = 14;\n                break;\n              }\n              h(this.client, e);\n              _context.next = 11;\n              return this.client.request(e);\n            case 11:\n              _context.t1 = _context.sent;\n              _context.next = 15;\n              break;\n            case 14:\n              _context.t1 = this.getHttpProvider().request(e.request);\n            case 15:\n              return _context.abrupt(\"return\", _context.t1);\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function request(_x) {\n        return _request.apply(this, arguments);\n      }\n      return request;\n    }()\n  }, {\n    key: \"updateNamespace\",\n    value: function updateNamespace(e) {\n      this.namespace = Object.assign(this.namespace, e);\n    }\n  }, {\n    key: \"setDefaultChain\",\n    value: function setDefaultChain(e, t) {\n      var s = g(e);\n      if (!this.httpProviders[s]) {\n        var n = t || a(\"\".concat(this.name, \":\").concat(s), this.namespace, this.client.core.projectId);\n        if (!n) throw new Error(\"No RPC url provided for chainId: \".concat(s));\n        this.setHttpProvider(s, n);\n      }\n      this.chainId = s, this.events.emit(o.DEFAULT_CHAIN_CHANGED, \"\".concat(this.name, \":\").concat(s));\n    }\n  }, {\n    key: \"requestAccounts\",\n    value: function requestAccounts() {\n      return this.getAccounts();\n    }\n  }, {\n    key: \"getDefaultChain\",\n    value: function getDefaultChain() {\n      if (this.chainId) return this.chainId.toString();\n      if (this.namespace.defaultChain) return this.namespace.defaultChain;\n      var e = this.namespace.chains[0];\n      if (!e) throw new Error(\"ChainId not found\");\n      return e.split(\":\")[1];\n    }\n  }, {\n    key: \"createHttpProvider\",\n    value: function createHttpProvider(e, t) {\n      var s = t || a(\"\".concat(this.name, \":\").concat(e), this.namespace, this.client.core.projectId);\n      return typeof s > \"u\" ? void 0 : new c(new T(s));\n    }\n  }, {\n    key: \"setHttpProvider\",\n    value: function setHttpProvider(e, t) {\n      var s = this.createHttpProvider(e, t);\n      s && (this.httpProviders[e] = s);\n    }\n  }, {\n    key: \"createHttpProviders\",\n    value: function createHttpProviders() {\n      var _this = this;\n      var e = {};\n      return this.namespace.chains.forEach(function (t) {\n        var s;\n        var n = g(t);\n        e[n] = _this.createHttpProvider(n, (s = _this.namespace.rpcMap) == null ? void 0 : s[t]);\n      }), e;\n    }\n  }, {\n    key: \"getAccounts\",\n    value: function getAccounts() {\n      var _this2 = this;\n      var e = this.namespace.accounts;\n      return e ? _toConsumableArray(new Set(e.filter(function (t) {\n        return t.split(\":\")[1] === _this2.chainId.toString();\n      }).map(function (t) {\n        return t.split(\":\")[2];\n      }))) : [];\n    }\n  }, {\n    key: \"getHttpProvider\",\n    value: function getHttpProvider() {\n      var e = this.chainId,\n        t = this.httpProviders[e];\n      if (typeof t > \"u\") throw new Error(\"JSON-RPC provider for \".concat(e, \" not found\"));\n      return t;\n    }\n  }, {\n    key: \"handleSwitchChain\",\n    value: function handleSwitchChain(e) {\n      var t = parseInt(e, 16),\n        s = \"\".concat(this.name, \":\").concat(t);\n      K(s, this.namespace.chains), this.setDefaultChain(\"\".concat(t));\n    }\n  }]);\n  return Z;\n}();\nvar ee = /*#__PURE__*/function () {\n  function ee(e) {\n    _classCallCheck(this, ee);\n    this.name = \"solana\", this.namespace = e.namespace, this.events = e.events, this.client = e.client, this.chainId = this.getDefaultChain(), this.httpProviders = this.createHttpProviders();\n  }\n  _createClass(ee, [{\n    key: \"updateNamespace\",\n    value: function updateNamespace(e) {\n      this.namespace = Object.assign(this.namespace, e);\n    }\n  }, {\n    key: \"requestAccounts\",\n    value: function requestAccounts() {\n      return this.getAccounts();\n    }\n  }, {\n    key: \"request\",\n    value: function request(e) {\n      return this.namespace.methods.includes(e.request.method) ? (h(this.client, e), this.client.request(e)) : this.getHttpProvider().request(e.request);\n    }\n  }, {\n    key: \"setDefaultChain\",\n    value: function setDefaultChain(e, t) {\n      if (!this.httpProviders[e]) {\n        var s = t || a(\"\".concat(this.name, \":\").concat(e), this.namespace, this.client.core.projectId);\n        if (!s) throw new Error(\"No RPC url provided for chainId: \".concat(e));\n        this.setHttpProvider(e, s);\n      }\n      this.chainId = e, this.events.emit(o.DEFAULT_CHAIN_CHANGED, \"\".concat(this.name, \":\").concat(this.chainId));\n    }\n  }, {\n    key: \"getDefaultChain\",\n    value: function getDefaultChain() {\n      if (this.chainId) return this.chainId;\n      if (this.namespace.defaultChain) return this.namespace.defaultChain;\n      var e = this.namespace.chains[0];\n      if (!e) throw new Error(\"ChainId not found\");\n      return e.split(\":\")[1];\n    }\n  }, {\n    key: \"getAccounts\",\n    value: function getAccounts() {\n      var _this3 = this;\n      var e = this.namespace.accounts;\n      return e ? _toConsumableArray(new Set(e.filter(function (t) {\n        return t.split(\":\")[1] === _this3.chainId.toString();\n      }).map(function (t) {\n        return t.split(\":\")[2];\n      }))) : [];\n    }\n  }, {\n    key: \"createHttpProviders\",\n    value: function createHttpProviders() {\n      var _this4 = this;\n      var e = {};\n      return this.namespace.chains.forEach(function (t) {\n        var s;\n        e[t] = _this4.createHttpProvider(t, (s = _this4.namespace.rpcMap) == null ? void 0 : s[t]);\n      }), e;\n    }\n  }, {\n    key: \"getHttpProvider\",\n    value: function getHttpProvider() {\n      var e = \"\".concat(this.name, \":\").concat(this.chainId),\n        t = this.httpProviders[e];\n      if (typeof t > \"u\") throw new Error(\"JSON-RPC provider for \".concat(e, \" not found\"));\n      return t;\n    }\n  }, {\n    key: \"setHttpProvider\",\n    value: function setHttpProvider(e, t) {\n      var s = this.createHttpProvider(e, t);\n      s && (this.httpProviders[e] = s);\n    }\n  }, {\n    key: \"createHttpProvider\",\n    value: function createHttpProvider(e, t) {\n      var s = t || a(e, this.namespace, this.client.core.projectId);\n      return typeof s > \"u\" ? void 0 : new c(new d(s));\n    }\n  }]);\n  return ee;\n}();\nvar te = /*#__PURE__*/function () {\n  function te(e) {\n    _classCallCheck(this, te);\n    this.name = \"cosmos\", this.namespace = e.namespace, this.events = e.events, this.client = e.client, this.chainId = this.getDefaultChain(), this.httpProviders = this.createHttpProviders();\n  }\n  _createClass(te, [{\n    key: \"updateNamespace\",\n    value: function updateNamespace(e) {\n      this.namespace = Object.assign(this.namespace, e);\n    }\n  }, {\n    key: \"requestAccounts\",\n    value: function requestAccounts() {\n      return this.getAccounts();\n    }\n  }, {\n    key: \"getDefaultChain\",\n    value: function getDefaultChain() {\n      if (this.chainId) return this.chainId;\n      if (this.namespace.defaultChain) return this.namespace.defaultChain;\n      var e = this.namespace.chains[0];\n      if (!e) throw new Error(\"ChainId not found\");\n      return e.split(\":\")[1];\n    }\n  }, {\n    key: \"request\",\n    value: function request(e) {\n      return this.namespace.methods.includes(e.request.method) ? (h(this.client, e), this.client.request(e)) : this.getHttpProvider().request(e.request);\n    }\n  }, {\n    key: \"setDefaultChain\",\n    value: function setDefaultChain(e, t) {\n      if (this.chainId = e, !this.httpProviders[e]) {\n        var s = t || a(\"\".concat(this.name, \":\").concat(e), this.namespace, this.client.core.projectId);\n        if (!s) throw new Error(\"No RPC url provided for chainId: \".concat(e));\n        this.setHttpProvider(e, s);\n      }\n      this.events.emit(o.DEFAULT_CHAIN_CHANGED, \"\".concat(this.name, \":\").concat(this.chainId));\n    }\n  }, {\n    key: \"getAccounts\",\n    value: function getAccounts() {\n      var _this5 = this;\n      var e = this.namespace.accounts;\n      return e ? _toConsumableArray(new Set(e.filter(function (t) {\n        return t.split(\":\")[1] === _this5.chainId.toString();\n      }).map(function (t) {\n        return t.split(\":\")[2];\n      }))) : [];\n    }\n  }, {\n    key: \"createHttpProviders\",\n    value: function createHttpProviders() {\n      var _this6 = this;\n      var e = {};\n      return this.namespace.chains.forEach(function (t) {\n        var s;\n        e[t] = _this6.createHttpProvider(t, (s = _this6.namespace.rpcMap) == null ? void 0 : s[t]);\n      }), e;\n    }\n  }, {\n    key: \"getHttpProvider\",\n    value: function getHttpProvider() {\n      var e = \"\".concat(this.name, \":\").concat(this.chainId),\n        t = this.httpProviders[e];\n      if (typeof t > \"u\") throw new Error(\"JSON-RPC provider for \".concat(e, \" not found\"));\n      return t;\n    }\n  }, {\n    key: \"setHttpProvider\",\n    value: function setHttpProvider(e, t) {\n      var s = this.createHttpProvider(e, t);\n      s && (this.httpProviders[e] = s);\n    }\n  }, {\n    key: \"createHttpProvider\",\n    value: function createHttpProvider(e, t) {\n      var s = t || a(e, this.namespace, this.client.core.projectId);\n      return typeof s > \"u\" ? void 0 : new c(new d(s));\n    }\n  }]);\n  return te;\n}();\nvar se = /*#__PURE__*/function () {\n  function se(e) {\n    _classCallCheck(this, se);\n    this.name = \"cip34\", this.namespace = e.namespace, this.events = e.events, this.client = e.client, this.chainId = this.getDefaultChain(), this.httpProviders = this.createHttpProviders();\n  }\n  _createClass(se, [{\n    key: \"updateNamespace\",\n    value: function updateNamespace(e) {\n      this.namespace = Object.assign(this.namespace, e);\n    }\n  }, {\n    key: \"requestAccounts\",\n    value: function requestAccounts() {\n      return this.getAccounts();\n    }\n  }, {\n    key: \"getDefaultChain\",\n    value: function getDefaultChain() {\n      if (this.chainId) return this.chainId;\n      if (this.namespace.defaultChain) return this.namespace.defaultChain;\n      var e = this.namespace.chains[0];\n      if (!e) throw new Error(\"ChainId not found\");\n      return e.split(\":\")[1];\n    }\n  }, {\n    key: \"request\",\n    value: function request(e) {\n      return this.namespace.methods.includes(e.request.method) ? (h(this.client, e), this.client.request(e)) : this.getHttpProvider().request(e.request);\n    }\n  }, {\n    key: \"setDefaultChain\",\n    value: function setDefaultChain(e, t) {\n      if (this.chainId = e, !this.httpProviders[e]) {\n        var s = t || this.getCardanoRPCUrl(e);\n        if (!s) throw new Error(\"No RPC url provided for chainId: \".concat(e));\n        this.setHttpProvider(e, s);\n      }\n      this.events.emit(o.DEFAULT_CHAIN_CHANGED, \"\".concat(this.name, \":\").concat(this.chainId));\n    }\n  }, {\n    key: \"getAccounts\",\n    value: function getAccounts() {\n      var _this7 = this;\n      var e = this.namespace.accounts;\n      return e ? _toConsumableArray(new Set(e.filter(function (t) {\n        return t.split(\":\")[1] === _this7.chainId.toString();\n      }).map(function (t) {\n        return t.split(\":\")[2];\n      }))) : [];\n    }\n  }, {\n    key: \"createHttpProviders\",\n    value: function createHttpProviders() {\n      var _this8 = this;\n      var e = {};\n      return this.namespace.chains.forEach(function (t) {\n        var s = _this8.getCardanoRPCUrl(t);\n        e[t] = _this8.createHttpProvider(t, s);\n      }), e;\n    }\n  }, {\n    key: \"getHttpProvider\",\n    value: function getHttpProvider() {\n      var e = \"\".concat(this.name, \":\").concat(this.chainId),\n        t = this.httpProviders[e];\n      if (typeof t > \"u\") throw new Error(\"JSON-RPC provider for \".concat(e, \" not found\"));\n      return t;\n    }\n  }, {\n    key: \"getCardanoRPCUrl\",\n    value: function getCardanoRPCUrl(e) {\n      var t = this.namespace.rpcMap;\n      if (t) return t[e];\n    }\n  }, {\n    key: \"setHttpProvider\",\n    value: function setHttpProvider(e, t) {\n      var s = this.createHttpProvider(e, t);\n      s && (this.httpProviders[e] = s);\n    }\n  }, {\n    key: \"createHttpProvider\",\n    value: function createHttpProvider(e, t) {\n      var s = t || this.getCardanoRPCUrl(e);\n      return typeof s > \"u\" ? void 0 : new c(new d(s));\n    }\n  }]);\n  return se;\n}();\nvar ie = /*#__PURE__*/function () {\n  function ie(e) {\n    _classCallCheck(this, ie);\n    this.name = \"elrond\", this.namespace = e.namespace, this.events = e.events, this.client = e.client, this.chainId = this.getDefaultChain(), this.httpProviders = this.createHttpProviders();\n  }\n  _createClass(ie, [{\n    key: \"updateNamespace\",\n    value: function updateNamespace(e) {\n      this.namespace = Object.assign(this.namespace, e);\n    }\n  }, {\n    key: \"requestAccounts\",\n    value: function requestAccounts() {\n      return this.getAccounts();\n    }\n  }, {\n    key: \"request\",\n    value: function request(e) {\n      return this.namespace.methods.includes(e.request.method) ? (h(this.client, e), this.client.request(e)) : this.getHttpProvider().request(e.request);\n    }\n  }, {\n    key: \"setDefaultChain\",\n    value: function setDefaultChain(e, t) {\n      if (!this.httpProviders[e]) {\n        var s = t || a(\"\".concat(this.name, \":\").concat(e), this.namespace, this.client.core.projectId);\n        if (!s) throw new Error(\"No RPC url provided for chainId: \".concat(e));\n        this.setHttpProvider(e, s);\n      }\n      this.chainId = e, this.events.emit(o.DEFAULT_CHAIN_CHANGED, \"\".concat(this.name, \":\").concat(this.chainId));\n    }\n  }, {\n    key: \"getDefaultChain\",\n    value: function getDefaultChain() {\n      if (this.chainId) return this.chainId;\n      if (this.namespace.defaultChain) return this.namespace.defaultChain;\n      var e = this.namespace.chains[0];\n      if (!e) throw new Error(\"ChainId not found\");\n      return e.split(\":\")[1];\n    }\n  }, {\n    key: \"getAccounts\",\n    value: function getAccounts() {\n      var _this9 = this;\n      var e = this.namespace.accounts;\n      return e ? _toConsumableArray(new Set(e.filter(function (t) {\n        return t.split(\":\")[1] === _this9.chainId.toString();\n      }).map(function (t) {\n        return t.split(\":\")[2];\n      }))) : [];\n    }\n  }, {\n    key: \"createHttpProviders\",\n    value: function createHttpProviders() {\n      var _this10 = this;\n      var e = {};\n      return this.namespace.chains.forEach(function (t) {\n        var s;\n        e[t] = _this10.createHttpProvider(t, (s = _this10.namespace.rpcMap) == null ? void 0 : s[t]);\n      }), e;\n    }\n  }, {\n    key: \"getHttpProvider\",\n    value: function getHttpProvider() {\n      var e = \"\".concat(this.name, \":\").concat(this.chainId),\n        t = this.httpProviders[e];\n      if (typeof t > \"u\") throw new Error(\"JSON-RPC provider for \".concat(e, \" not found\"));\n      return t;\n    }\n  }, {\n    key: \"setHttpProvider\",\n    value: function setHttpProvider(e, t) {\n      var s = this.createHttpProvider(e, t);\n      s && (this.httpProviders[e] = s);\n    }\n  }, {\n    key: \"createHttpProvider\",\n    value: function createHttpProvider(e, t) {\n      var s = t || a(e, this.namespace, this.client.core.projectId);\n      return typeof s > \"u\" ? void 0 : new c(new d(s));\n    }\n  }]);\n  return ie;\n}();\nvar ne = /*#__PURE__*/function () {\n  function ne(e) {\n    _classCallCheck(this, ne);\n    this.name = \"multiversx\", this.namespace = e.namespace, this.events = e.events, this.client = e.client, this.chainId = this.getDefaultChain(), this.httpProviders = this.createHttpProviders();\n  }\n  _createClass(ne, [{\n    key: \"updateNamespace\",\n    value: function updateNamespace(e) {\n      this.namespace = Object.assign(this.namespace, e);\n    }\n  }, {\n    key: \"requestAccounts\",\n    value: function requestAccounts() {\n      return this.getAccounts();\n    }\n  }, {\n    key: \"request\",\n    value: function request(e) {\n      return this.namespace.methods.includes(e.request.method) ? (h(this.client, e), this.client.request(e)) : this.getHttpProvider().request(e.request);\n    }\n  }, {\n    key: \"setDefaultChain\",\n    value: function setDefaultChain(e, t) {\n      if (!this.httpProviders[e]) {\n        var s = t || a(\"\".concat(this.name, \":\").concat(e), this.namespace, this.client.core.projectId);\n        if (!s) throw new Error(\"No RPC url provided for chainId: \".concat(e));\n        this.setHttpProvider(e, s);\n      }\n      this.chainId = e, this.events.emit(o.DEFAULT_CHAIN_CHANGED, \"\".concat(this.name, \":\").concat(this.chainId));\n    }\n  }, {\n    key: \"getDefaultChain\",\n    value: function getDefaultChain() {\n      if (this.chainId) return this.chainId;\n      if (this.namespace.defaultChain) return this.namespace.defaultChain;\n      var e = this.namespace.chains[0];\n      if (!e) throw new Error(\"ChainId not found\");\n      return e.split(\":\")[1];\n    }\n  }, {\n    key: \"getAccounts\",\n    value: function getAccounts() {\n      var _this11 = this;\n      var e = this.namespace.accounts;\n      return e ? _toConsumableArray(new Set(e.filter(function (t) {\n        return t.split(\":\")[1] === _this11.chainId.toString();\n      }).map(function (t) {\n        return t.split(\":\")[2];\n      }))) : [];\n    }\n  }, {\n    key: \"createHttpProviders\",\n    value: function createHttpProviders() {\n      var _this12 = this;\n      var e = {};\n      return this.namespace.chains.forEach(function (t) {\n        var s;\n        e[t] = _this12.createHttpProvider(t, (s = _this12.namespace.rpcMap) == null ? void 0 : s[t]);\n      }), e;\n    }\n  }, {\n    key: \"getHttpProvider\",\n    value: function getHttpProvider() {\n      var e = \"\".concat(this.name, \":\").concat(this.chainId),\n        t = this.httpProviders[e];\n      if (typeof t > \"u\") throw new Error(\"JSON-RPC provider for \".concat(e, \" not found\"));\n      return t;\n    }\n  }, {\n    key: \"setHttpProvider\",\n    value: function setHttpProvider(e, t) {\n      var s = this.createHttpProvider(e, t);\n      s && (this.httpProviders[e] = s);\n    }\n  }, {\n    key: \"createHttpProvider\",\n    value: function createHttpProvider(e, t) {\n      var s = t || a(e, this.namespace, this.client.core.projectId);\n      return typeof s > \"u\" ? void 0 : new c(new d(s));\n    }\n  }]);\n  return ne;\n}();\nvar re = Object.defineProperty,\n  ae = Object.defineProperties,\n  oe = Object.getOwnPropertyDescriptors,\n  O = Object.getOwnPropertySymbols,\n  ce = Object.prototype.hasOwnProperty,\n  he = Object.prototype.propertyIsEnumerable,\n  b = function b(i, e, t) {\n    return e in i ? re(i, e, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: t\n    }) : i[e] = t;\n  },\n  u = function u(i, e) {\n    for (var t in e || (e = {})) ce.call(e, t) && b(i, t, e[t]);\n    if (O) {\n      var _iterator2 = _createForOfIteratorHelper(O(e)),\n        _step2;\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var t = _step2.value;\n          he.call(e, t) && b(i, t, e[t]);\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n    }\n    return i;\n  },\n  w = function w(i, e) {\n    return ae(i, oe(e));\n  };\nvar m = /*#__PURE__*/function () {\n  function m(e) {\n    _classCallCheck(this, m);\n    this.events = new F(), this.rpcProviders = {}, this.shouldAbortPairingAttempt = !1, this.maxPairingAttempts = 10, this.providerOpts = e, this.logger = typeof (e === null || e === void 0 ? void 0 : e.logger) < \"u\" && typeof (e === null || e === void 0 ? void 0 : e.logger) != \"string\" ? e.logger : _(U({\n      level: (e === null || e === void 0 ? void 0 : e.logger) || I\n    }));\n  }\n  _createClass(m, [{\n    key: \"request\",\n    value: function () {\n      var _request2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e, t) {\n        var _this$validateChain, _this$validateChain2, s, n;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _this$validateChain = this.validateChain(t), _this$validateChain2 = _slicedToArray(_this$validateChain, 2), s = _this$validateChain2[0], n = _this$validateChain2[1];\n              if (this.session) {\n                _context2.next = 3;\n                break;\n              }\n              throw new Error(\"Please call connect() before request()\");\n            case 3:\n              _context2.next = 5;\n              return this.getProvider(s).request({\n                request: u({}, e),\n                chainId: \"\".concat(s, \":\").concat(n),\n                topic: this.session.topic\n              });\n            case 5:\n              return _context2.abrupt(\"return\", _context2.sent);\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function request(_x2, _x3) {\n        return _request2.apply(this, arguments);\n      }\n      return request;\n    }()\n  }, {\n    key: \"sendAsync\",\n    value: function sendAsync(e, t, s) {\n      this.request(e, s).then(function (n) {\n        return t(null, n);\n      }).catch(function (n) {\n        return t(n, void 0);\n      });\n    }\n  }, {\n    key: \"enable\",\n    value: function () {\n      var _enable = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              if (this.client) {\n                _context3.next = 2;\n                break;\n              }\n              throw new Error(\"Sign Client not initialized\");\n            case 2:\n              _context3.t0 = this.session;\n              if (_context3.t0) {\n                _context3.next = 6;\n                break;\n              }\n              _context3.next = 6;\n              return this.connect({\n                namespaces: this.namespaces,\n                optionalNamespaces: this.optionalNamespaces,\n                sessionProperties: this.sessionProperties\n              });\n            case 6:\n              _context3.next = 8;\n              return this.requestAccounts();\n            case 8:\n              return _context3.abrupt(\"return\", _context3.sent);\n            case 9:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function enable() {\n        return _enable.apply(this, arguments);\n      }\n      return enable;\n    }()\n  }, {\n    key: \"disconnect\",\n    value: function () {\n      var _disconnect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var e;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              if (this.session) {\n                _context4.next = 2;\n                break;\n              }\n              throw new Error(\"Please call connect() before enable()\");\n            case 2:\n              _context4.next = 4;\n              return this.client.disconnect({\n                topic: (e = this.session) == null ? void 0 : e.topic,\n                reason: C(\"USER_DISCONNECTED\")\n              });\n            case 4:\n              _context4.next = 6;\n              return this.cleanup();\n            case 6:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this);\n      }));\n      function disconnect() {\n        return _disconnect.apply(this, arguments);\n      }\n      return disconnect;\n    }()\n  }, {\n    key: \"connect\",\n    value: function () {\n      var _connect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(e) {\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              if (this.client) {\n                _context5.next = 2;\n                break;\n              }\n              throw new Error(\"Sign Client not initialized\");\n            case 2:\n              this.setNamespaces(e);\n              _context5.next = 5;\n              return this.cleanupPendingPairings();\n            case 5:\n              if (e.skipPairing) {\n                _context5.next = 9;\n                break;\n              }\n              _context5.next = 8;\n              return this.pair(e.pairingTopic);\n            case 8:\n              return _context5.abrupt(\"return\", _context5.sent);\n            case 9:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, this);\n      }));\n      function connect(_x4) {\n        return _connect.apply(this, arguments);\n      }\n      return connect;\n    }()\n  }, {\n    key: \"on\",\n    value: function on(e, t) {\n      this.events.on(e, t);\n    }\n  }, {\n    key: \"once\",\n    value: function once(e, t) {\n      this.events.once(e, t);\n    }\n  }, {\n    key: \"removeListener\",\n    value: function removeListener(e, t) {\n      this.events.removeListener(e, t);\n    }\n  }, {\n    key: \"off\",\n    value: function off(e, t) {\n      this.events.off(e, t);\n    }\n  }, {\n    key: \"isWalletConnect\",\n    get: function get() {\n      return !0;\n    }\n  }, {\n    key: \"pair\",\n    value: function () {\n      var _pair = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(e) {\n        var _this13 = this;\n        var t, _yield$this$client$co, s, n;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              this.shouldAbortPairingAttempt = !1;\n              t = 0;\n            case 2:\n              if (!this.shouldAbortPairingAttempt) {\n                _context6.next = 4;\n                break;\n              }\n              throw new Error(\"Pairing aborted\");\n            case 4:\n              if (!(t >= this.maxPairingAttempts)) {\n                _context6.next = 6;\n                break;\n              }\n              throw new Error(\"Max auto pairing attempts reached\");\n            case 6:\n              _context6.next = 8;\n              return this.client.connect({\n                pairingTopic: e,\n                requiredNamespaces: this.namespaces,\n                optionalNamespaces: this.optionalNamespaces,\n                sessionProperties: this.sessionProperties\n              });\n            case 8:\n              _yield$this$client$co = _context6.sent;\n              s = _yield$this$client$co.uri;\n              n = _yield$this$client$co.approval;\n              s && (this.uri = s, this.events.emit(\"display_uri\", s));\n              _context6.next = 14;\n              return n().then(function (r) {\n                _this13.session = r;\n              }).catch(function (r) {\n                if (r.message !== R) throw r;\n                t++;\n              });\n            case 14:\n              if (!this.session) {\n                _context6.next = 2;\n                break;\n              }\n            case 15:\n              return _context6.abrupt(\"return\", (this.onConnect(), this.session));\n            case 16:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6, this);\n      }));\n      function pair(_x5) {\n        return _pair.apply(this, arguments);\n      }\n      return pair;\n    }()\n  }, {\n    key: \"setDefaultChain\",\n    value: function setDefaultChain(e, t) {\n      try {\n        var _this$validateChain3 = this.validateChain(e),\n          _this$validateChain4 = _slicedToArray(_this$validateChain3, 2),\n          s = _this$validateChain4[0],\n          n = _this$validateChain4[1];\n        this.getProvider(s).setDefaultChain(n, t);\n      } catch (s) {\n        if (!/Please call connect/.test(s.message)) throw s;\n      }\n    }\n  }, {\n    key: \"cleanupPendingPairings\",\n    value: function () {\n      var _cleanupPendingPairings = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7() {\n        var e,\n          t,\n          _iterator3,\n          _step3,\n          s,\n          _args7 = arguments;\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) switch (_context7.prev = _context7.next) {\n            case 0:\n              e = _args7.length > 0 && _args7[0] !== undefined ? _args7[0] : {};\n              this.logger.info(\"Cleaning up inactive pairings...\");\n              t = this.client.pairing.getAll();\n              if (!k(t)) {\n                _context7.next = 26;\n                break;\n              }\n              _iterator3 = _createForOfIteratorHelper(t);\n              _context7.prev = 5;\n              _iterator3.s();\n            case 7:\n              if ((_step3 = _iterator3.n()).done) {\n                _context7.next = 17;\n                break;\n              }\n              s = _step3.value;\n              if (!e.deletePairings) {\n                _context7.next = 13;\n                break;\n              }\n              this.client.core.expirer.set(s.topic, 0);\n              _context7.next = 15;\n              break;\n            case 13:\n              _context7.next = 15;\n              return this.client.core.relayer.subscriber.unsubscribe(s.topic);\n            case 15:\n              _context7.next = 7;\n              break;\n            case 17:\n              _context7.next = 22;\n              break;\n            case 19:\n              _context7.prev = 19;\n              _context7.t0 = _context7[\"catch\"](5);\n              _iterator3.e(_context7.t0);\n            case 22:\n              _context7.prev = 22;\n              _iterator3.f();\n              return _context7.finish(22);\n            case 25:\n              this.logger.info(\"Inactive pairings cleared: \".concat(t.length));\n            case 26:\n            case \"end\":\n              return _context7.stop();\n          }\n        }, _callee7, this, [[5, 19, 22, 25]]);\n      }));\n      function cleanupPendingPairings() {\n        return _cleanupPendingPairings.apply(this, arguments);\n      }\n      return cleanupPendingPairings;\n    }()\n  }, {\n    key: \"abortPairingAttempt\",\n    value: function abortPairingAttempt() {\n      this.shouldAbortPairingAttempt = !0;\n    }\n  }, {\n    key: \"checkStorage\",\n    value: function () {\n      var _checkStorage = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8() {\n        var e;\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.next = 2;\n              return this.getFromStore(\"namespaces\");\n            case 2:\n              _context8.t0 = _context8.sent;\n              if (_context8.t0) {\n                _context8.next = 5;\n                break;\n              }\n              _context8.t0 = {};\n            case 5:\n              this.namespaces = _context8.t0;\n              _context8.next = 8;\n              return this.getFromStore(\"optionalNamespaces\");\n            case 8:\n              _context8.t1 = _context8.sent;\n              if (_context8.t1) {\n                _context8.next = 11;\n                break;\n              }\n              _context8.t1 = {};\n            case 11:\n              this.optionalNamespaces = _context8.t1;\n              if (!this.client.session.length) {\n                _context8.next = 15;\n                break;\n              }\n              e = this.client.session.keys.length - 1;\n              this.session = this.client.session.get(this.client.session.keys[e]), this.createProviders();\n            case 15:\n            case \"end\":\n              return _context8.stop();\n          }\n        }, _callee8, this);\n      }));\n      function checkStorage() {\n        return _checkStorage.apply(this, arguments);\n      }\n      return checkStorage;\n    }()\n  }, {\n    key: \"initialize\",\n    value: function () {\n      var _initialize = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9() {\n        return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n          while (1) switch (_context9.prev = _context9.next) {\n            case 0:\n              this.logger.trace(\"Initialized\");\n              _context9.next = 3;\n              return this.createClient();\n            case 3:\n              _context9.next = 5;\n              return this.checkStorage();\n            case 5:\n              this.registerEventListeners();\n            case 6:\n            case \"end\":\n              return _context9.stop();\n          }\n        }, _callee9, this);\n      }));\n      function initialize() {\n        return _initialize.apply(this, arguments);\n      }\n      return initialize;\n    }()\n  }, {\n    key: \"createClient\",\n    value: function () {\n      var _createClient = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10() {\n        return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n          while (1) switch (_context10.prev = _context10.next) {\n            case 0:\n              _context10.t0 = this.providerOpts.client;\n              if (_context10.t0) {\n                _context10.next = 5;\n                break;\n              }\n              _context10.next = 4;\n              return j.init({\n                logger: this.providerOpts.logger || I,\n                relayUrl: this.providerOpts.relayUrl || M,\n                projectId: this.providerOpts.projectId,\n                metadata: this.providerOpts.metadata,\n                storageOptions: this.providerOpts.storageOptions,\n                name: this.providerOpts.name\n              });\n            case 4:\n              _context10.t0 = _context10.sent;\n            case 5:\n              this.client = _context10.t0;\n              this.logger.trace(\"SignClient Initialized\");\n            case 7:\n            case \"end\":\n              return _context10.stop();\n          }\n        }, _callee10, this);\n      }));\n      function createClient() {\n        return _createClient.apply(this, arguments);\n      }\n      return createClient;\n    }()\n  }, {\n    key: \"createProviders\",\n    value: function createProviders() {\n      var _this14 = this;\n      if (!this.client) throw new Error(\"Sign Client not initialized\");\n      if (!this.session) throw new Error(\"Session not initialized. Please call connect() before enable()\");\n      _toConsumableArray(new Set(Object.keys(this.session.namespaces).map(function (e) {\n        return N(e);\n      }))).forEach(function (e) {\n        if (!_this14.session) return;\n        var t = Y(e, _this14.session),\n          s = X(t),\n          n = B(_this14.namespaces, _this14.optionalNamespaces),\n          r = w(u({}, n[e]), {\n            accounts: t,\n            chains: s\n          });\n        switch (e) {\n          case \"eip155\":\n            _this14.rpcProviders[e] = new Z({\n              client: _this14.client,\n              namespace: r,\n              events: _this14.events\n            });\n            break;\n          case \"solana\":\n            _this14.rpcProviders[e] = new ee({\n              client: _this14.client,\n              namespace: r,\n              events: _this14.events\n            });\n            break;\n          case \"cosmos\":\n            _this14.rpcProviders[e] = new te({\n              client: _this14.client,\n              namespace: r,\n              events: _this14.events\n            });\n            break;\n          case \"polkadot\":\n            break;\n          case \"cip34\":\n            _this14.rpcProviders[e] = new se({\n              client: _this14.client,\n              namespace: r,\n              events: _this14.events\n            });\n            break;\n          case \"elrond\":\n            _this14.rpcProviders[e] = new ie({\n              client: _this14.client,\n              namespace: r,\n              events: _this14.events\n            });\n            break;\n          case \"multiversx\":\n            _this14.rpcProviders[e] = new ne({\n              client: _this14.client,\n              namespace: r,\n              events: _this14.events\n            });\n            break;\n        }\n      });\n    }\n  }, {\n    key: \"registerEventListeners\",\n    value: function registerEventListeners() {\n      var _this15 = this;\n      if (typeof this.client > \"u\") throw new Error(\"Sign Client is not initialized\");\n      this.client.on(\"session_ping\", function (e) {\n        _this15.events.emit(\"session_ping\", e);\n      }), this.client.on(\"session_event\", function (e) {\n        var t = e.params,\n          s = t.event;\n        s.name === \"accountsChanged\" ? _this15.events.emit(\"accountsChanged\", s.data) : s.name === \"chainChanged\" ? _this15.onChainChanged(t.chainId) : _this15.events.emit(s.name, s.data), _this15.events.emit(\"session_event\", e);\n      }), this.client.on(\"session_update\", function (_ref) {\n        var e = _ref.topic,\n          t = _ref.params;\n        var s;\n        var n = t.namespaces,\n          r = (s = _this15.client) == null ? void 0 : s.session.get(e);\n        _this15.session = w(u({}, r), {\n          namespaces: n\n        }), _this15.onSessionUpdate(), _this15.events.emit(\"session_update\", {\n          topic: e,\n          params: t\n        });\n      }), this.client.on(\"session_delete\", /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11(e) {\n          return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n            while (1) switch (_context11.prev = _context11.next) {\n              case 0:\n                _context11.next = 2;\n                return _this15.cleanup();\n              case 2:\n                _this15.events.emit(\"session_delete\", e);\n                _this15.events.emit(\"disconnect\", w(u({}, C(\"USER_DISCONNECTED\")), {\n                  data: e.topic\n                }));\n              case 4:\n              case \"end\":\n                return _context11.stop();\n            }\n          }, _callee11);\n        }));\n        return function (_x6) {\n          return _ref2.apply(this, arguments);\n        };\n      }()), this.on(o.DEFAULT_CHAIN_CHANGED, function (e) {\n        _this15.onChainChanged(e, !0);\n      });\n    }\n  }, {\n    key: \"getProvider\",\n    value: function getProvider(e) {\n      if (!this.rpcProviders[e]) throw new Error(\"Provider not found: \".concat(e));\n      return this.rpcProviders[e];\n    }\n  }, {\n    key: \"onSessionUpdate\",\n    value: function onSessionUpdate() {\n      var _this16 = this;\n      Object.keys(this.rpcProviders).forEach(function (e) {\n        var t;\n        _this16.getProvider(e).updateNamespace((t = _this16.session) == null ? void 0 : t.namespaces[e]);\n      });\n    }\n  }, {\n    key: \"setNamespaces\",\n    value: function setNamespaces(e) {\n      var t = e.namespaces,\n        s = e.optionalNamespaces,\n        n = e.sessionProperties;\n      if (!t || !Object.keys(t).length) throw new Error(\"Namespaces must be not empty\");\n      this.namespaces = t, this.optionalNamespaces = s, this.sessionProperties = n, this.persist(\"namespaces\", t), this.persist(\"optionalNamespaces\", s);\n    }\n  }, {\n    key: \"validateChain\",\n    value: function validateChain(e) {\n      var _ref3 = (e === null || e === void 0 ? void 0 : e.split(\":\")) || [\"\", \"\"],\n        _ref4 = _slicedToArray(_ref3, 2),\n        t = _ref4[0],\n        s = _ref4[1];\n      if (t && !Object.keys(this.namespaces).includes(t)) throw new Error(\"Namespace '\".concat(t, \"' is not configured. Please call connect() first with namespace config.\"));\n      if (t && s) return [t, s];\n      var n = Object.keys(this.namespaces)[0],\n        r = this.rpcProviders[n].getDefaultChain();\n      return [n, r];\n    }\n  }, {\n    key: \"requestAccounts\",\n    value: function () {\n      var _requestAccounts = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee12() {\n        var _this$validateChain5, _this$validateChain6, e;\n        return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n          while (1) switch (_context12.prev = _context12.next) {\n            case 0:\n              _this$validateChain5 = this.validateChain(), _this$validateChain6 = _slicedToArray(_this$validateChain5, 1), e = _this$validateChain6[0];\n              _context12.next = 3;\n              return this.getProvider(e).requestAccounts();\n            case 3:\n              return _context12.abrupt(\"return\", _context12.sent);\n            case 4:\n            case \"end\":\n              return _context12.stop();\n          }\n        }, _callee12, this);\n      }));\n      function requestAccounts() {\n        return _requestAccounts.apply(this, arguments);\n      }\n      return requestAccounts;\n    }()\n  }, {\n    key: \"onChainChanged\",\n    value: function onChainChanged(e) {\n      var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n      var _this$validateChain7 = this.validateChain(e),\n        _this$validateChain8 = _slicedToArray(_this$validateChain7, 2),\n        s = _this$validateChain8[0],\n        n = _this$validateChain8[1];\n      t || this.getProvider(s).setDefaultChain(n), this.namespaces[s].defaultChain = n, this.persist(\"namespaces\", this.namespaces), this.events.emit(\"chainChanged\", n);\n    }\n  }, {\n    key: \"onConnect\",\n    value: function onConnect() {\n      this.createProviders(), this.events.emit(\"connect\", {\n        session: this.session\n      });\n    }\n  }, {\n    key: \"cleanup\",\n    value: function () {\n      var _cleanup = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee13() {\n        return _regeneratorRuntime().wrap(function _callee13$(_context13) {\n          while (1) switch (_context13.prev = _context13.next) {\n            case 0:\n              this.session = void 0;\n              _context13.next = 3;\n              return this.cleanupPendingPairings({\n                deletePairings: !0\n              });\n            case 3:\n            case \"end\":\n              return _context13.stop();\n          }\n        }, _callee13, this);\n      }));\n      function cleanup() {\n        return _cleanup.apply(this, arguments);\n      }\n      return cleanup;\n    }()\n  }, {\n    key: \"persist\",\n    value: function persist(e, t) {\n      this.client.core.storage.setItem(\"\".concat(E, \"/\").concat(e), t);\n    }\n  }, {\n    key: \"getFromStore\",\n    value: function () {\n      var _getFromStore = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee14(e) {\n        return _regeneratorRuntime().wrap(function _callee14$(_context14) {\n          while (1) switch (_context14.prev = _context14.next) {\n            case 0:\n              _context14.next = 2;\n              return this.client.core.storage.getItem(\"\".concat(E, \"/\").concat(e));\n            case 2:\n              return _context14.abrupt(\"return\", _context14.sent);\n            case 3:\n            case \"end\":\n              return _context14.stop();\n          }\n        }, _callee14, this);\n      }));\n      function getFromStore(_x7) {\n        return _getFromStore.apply(this, arguments);\n      }\n      return getFromStore;\n    }()\n  }], [{\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee15(e) {\n        var t;\n        return _regeneratorRuntime().wrap(function _callee15$(_context15) {\n          while (1) switch (_context15.prev = _context15.next) {\n            case 0:\n              t = new m(e);\n              _context15.next = 3;\n              return t.initialize();\n            case 3:\n              return _context15.abrupt(\"return\", t);\n            case 4:\n            case \"end\":\n              return _context15.stop();\n          }\n        }, _callee15);\n      }));\n      function init(_x8) {\n        return _init.apply(this, arguments);\n      }\n      return init;\n    }()\n  }]);\n  return m;\n}();\nvar pe = m;\nexport { pe as UniversalProvider, m as default };","map":{"version":3,"sources":[],"names":[],"mappings":"","sourcesContent":["import _ from\"pino\";import j,{PROPOSAL_EXPIRY_MESSAGE as R}from\"@walletconnect/sign-client\";import{isValidObject as L,getSdkError as C,isValidArray as k}from\"@walletconnect/utils\";import{getDefaultLoggerOptions as U}from\"@walletconnect/logger\";import{JsonRpcProvider as c}from\"@walletconnect/jsonrpc-provider\";import d,{HttpConnection as T}from\"@walletconnect/jsonrpc-http-connection\";import F from\"events\";const I=\"error\",M=\"wss://relay.walletconnect.com\",G=\"wc\",z=\"universal_provider\",E=`${G}@${2}:${z}:`,x=\"https://rpc.walletconnect.com/v1\",o={DEFAULT_CHAIN_CHANGED:\"default_chain_changed\"};var J=Object.defineProperty,$=Object.getOwnPropertySymbols,V=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable,H=(i,e,t)=>e in i?J(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,f=(i,e)=>{for(var t in e||(e={}))V.call(e,t)&&H(i,t,e[t]);if($)for(var t of $(e))W.call(e,t)&&H(i,t,e[t]);return i};function a(i,e,t){let s;const n=g(i);return e.rpcMap&&(s=e.rpcMap[n]),s||(s=`${x}?chainId=eip155:${n}&projectId=${t}`),s}function g(i){return i.includes(\"eip155\")?Number(i.split(\":\")[1]):Number(i)}function K(i,e){if(!e.includes(i))throw new Error(`Chain '${i}' not approved. Please use one of the following: ${e.toString()}`)}function X(i){return i.map(e=>`${e.split(\":\")[0]}:${e.split(\":\")[1]}`)}function Y(i,e){const t=Object.keys(e.namespaces).filter(n=>n.includes(i));if(!t.length)return[];const s=[];return t.forEach(n=>{const r=e.namespaces[n].accounts;s.push(...r)}),s}function B(i,e={}){const t=A(i),s=A(e);return f({},Object.assign(t,s))}function A(i){var e,t,s,n;const r={};if(!L(i))return r;for(const[v,l]of Object.entries(i)){const q=y(v)?[v]:l.chains,S=l.methods||[],D=l.events||[],p=N(v);r[p]={chains:P(q,(e=r[p])==null?void 0:e.chains),methods:P(S,(t=r[p])==null?void 0:t.methods),events:P(D,(s=r[p])==null?void 0:s.events),rpcMap:f(f({},(n=r[p])==null?void 0:n.rpcMap),l.rpcMap)}}return r}function y(i){return i.includes(\":\")}function N(i){return y(i)?i.split(\":\")[0]:i}function P(i=[],e=[]){return[...new Set([...i,...e])]}const h=(i,e)=>{const t=s=>{s.request!==e.request||s.topic!==e.topic||(i.events.removeListener(\"session_request_sent\",t),Q(e))};i.on(\"session_request_sent\",t)};function Q(i){if(typeof window<\"u\")try{const e=window.localStorage.getItem(\"WALLETCONNECT_DEEPLINK_CHOICE\");if(e){const t=JSON.parse(e),s=t?.href;if(typeof s==\"string\"){s.endsWith(\"/\")&&s.slice(0,-1);const n=`${s}/wc?requestId=${i.id}&sessionTopic=${i.topic}`;window.open(n,\"_self\",\"noreferrer noopener\")}}}catch(e){console.error(e)}}class Z{constructor(e){this.name=\"eip155\",this.namespace=e.namespace,this.client=e.client,this.events=e.events,this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){var t;switch(e.request.method){case\"eth_requestAccounts\":return this.getAccounts();case\"eth_accounts\":return this.getAccounts();case\"wallet_switchEthereumChain\":return this.handleSwitchChain(e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:\"0x0\"),null;case\"eth_chainId\":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?(h(this.client,e),await this.client.request(e)):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){const s=g(e);if(!this.httpProviders[s]){const n=t||a(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,n)}this.chainId=s,this.events.emit(o.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error(\"ChainId not found\");return e.split(\":\")[1]}createHttpProvider(e,t){const s=t||a(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof s>\"u\"?void 0:new c(new T(s))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const n=g(t);e[n]=this.createHttpProvider(n,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(\":\")[1]===this.chainId.toString()).map(t=>t.split(\":\")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>\"u\")throw new Error(`JSON-RPC provider for ${e} not found`);return t}handleSwitchChain(e){const t=parseInt(e,16),s=`${this.name}:${t}`;K(s,this.namespace.chains),this.setDefaultChain(`${t}`)}}class ee{constructor(e){this.name=\"solana\",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?(h(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||a(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(o.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error(\"ChainId not found\");return e.split(\":\")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(\":\")[1]===this.chainId.toString()).map(t=>t.split(\":\")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>\"u\")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||a(e,this.namespace,this.client.core.projectId);return typeof s>\"u\"?void 0:new c(new d(s))}}class te{constructor(e){this.name=\"cosmos\",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error(\"ChainId not found\");return e.split(\":\")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(h(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||a(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(o.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(\":\")[1]===this.chainId.toString()).map(t=>t.split(\":\")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>\"u\")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||a(e,this.namespace,this.client.core.projectId);return typeof s>\"u\"?void 0:new c(new d(s))}}class se{constructor(e){this.name=\"cip34\",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error(\"ChainId not found\");return e.split(\":\")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(h(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(o.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(\":\")[1]===this.chainId.toString()).map(t=>t.split(\":\")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t);e[t]=this.createHttpProvider(t,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>\"u\")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);return typeof s>\"u\"?void 0:new c(new d(s))}}class ie{constructor(e){this.name=\"elrond\",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?(h(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||a(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(o.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error(\"ChainId not found\");return e.split(\":\")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(\":\")[1]===this.chainId.toString()).map(t=>t.split(\":\")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>\"u\")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||a(e,this.namespace,this.client.core.projectId);return typeof s>\"u\"?void 0:new c(new d(s))}}class ne{constructor(e){this.name=\"multiversx\",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?(h(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||a(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(o.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error(\"ChainId not found\");return e.split(\":\")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(\":\")[1]===this.chainId.toString()).map(t=>t.split(\":\")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>\"u\")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||a(e,this.namespace,this.client.core.projectId);return typeof s>\"u\"?void 0:new c(new d(s))}}var re=Object.defineProperty,ae=Object.defineProperties,oe=Object.getOwnPropertyDescriptors,O=Object.getOwnPropertySymbols,ce=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable,b=(i,e,t)=>e in i?re(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,u=(i,e)=>{for(var t in e||(e={}))ce.call(e,t)&&b(i,t,e[t]);if(O)for(var t of O(e))he.call(e,t)&&b(i,t,e[t]);return i},w=(i,e)=>ae(i,oe(e));class m{constructor(e){this.events=new F,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.providerOpts=e,this.logger=typeof e?.logger<\"u\"&&typeof e?.logger!=\"string\"?e.logger:_(U({level:e?.logger||I}))}static async init(e){const t=new m(e);return await t.initialize(),t}async request(e,t){const[s,n]=this.validateChain(t);if(!this.session)throw new Error(\"Please call connect() before request()\");return await this.getProvider(s).request({request:u({},e),chainId:`${s}:${n}`,topic:this.session.topic})}sendAsync(e,t,s){this.request(e,s).then(n=>t(null,n)).catch(n=>t(n,void 0))}async enable(){if(!this.client)throw new Error(\"Sign Client not initialized\");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error(\"Please call connect() before enable()\");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:C(\"USER_DISCONNECTED\")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error(\"Sign Client not initialized\");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error(\"Pairing aborted\");if(t>=this.maxPairingAttempts)throw new Error(\"Max auto pairing attempts reached\");const{uri:s,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit(\"display_uri\",s)),await n().then(r=>{this.session=r}).catch(r=>{if(r.message!==R)throw r;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{const[s,n]=this.validateChain(e);this.getProvider(s).setDefaultChain(n,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info(\"Cleaning up inactive pairings...\");const t=this.client.pairing.getAll();if(k(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore(\"namespaces\")||{},this.optionalNamespaces=await this.getFromStore(\"optionalNamespaces\")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace(\"Initialized\"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await j.init({logger:this.providerOpts.logger||I,relayUrl:this.providerOpts.relayUrl||M,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace(\"SignClient Initialized\")}createProviders(){if(!this.client)throw new Error(\"Sign Client not initialized\");if(!this.session)throw new Error(\"Session not initialized. Please call connect() before enable()\");[...new Set(Object.keys(this.session.namespaces).map(e=>N(e)))].forEach(e=>{if(!this.session)return;const t=Y(e,this.session),s=X(t),n=B(this.namespaces,this.optionalNamespaces),r=w(u({},n[e]),{accounts:t,chains:s});switch(e){case\"eip155\":this.rpcProviders[e]=new Z({client:this.client,namespace:r,events:this.events});break;case\"solana\":this.rpcProviders[e]=new ee({client:this.client,namespace:r,events:this.events});break;case\"cosmos\":this.rpcProviders[e]=new te({client:this.client,namespace:r,events:this.events});break;case\"polkadot\":break;case\"cip34\":this.rpcProviders[e]=new se({client:this.client,namespace:r,events:this.events});break;case\"elrond\":this.rpcProviders[e]=new ie({client:this.client,namespace:r,events:this.events});break;case\"multiversx\":this.rpcProviders[e]=new ne({client:this.client,namespace:r,events:this.events});break}})}registerEventListeners(){if(typeof this.client>\"u\")throw new Error(\"Sign Client is not initialized\");this.client.on(\"session_ping\",e=>{this.events.emit(\"session_ping\",e)}),this.client.on(\"session_event\",e=>{const{params:t}=e,{event:s}=t;s.name===\"accountsChanged\"?this.events.emit(\"accountsChanged\",s.data):s.name===\"chainChanged\"?this.onChainChanged(t.chainId):this.events.emit(s.name,s.data),this.events.emit(\"session_event\",e)}),this.client.on(\"session_update\",({topic:e,params:t})=>{var s;const{namespaces:n}=t,r=(s=this.client)==null?void 0:s.session.get(e);this.session=w(u({},r),{namespaces:n}),this.onSessionUpdate(),this.events.emit(\"session_update\",{topic:e,params:t})}),this.client.on(\"session_delete\",async e=>{await this.cleanup(),this.events.emit(\"session_delete\",e),this.events.emit(\"disconnect\",w(u({},C(\"USER_DISCONNECTED\")),{data:e.topic}))}),this.on(o.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:n}=e;if(!t||!Object.keys(t).length)throw new Error(\"Namespaces must be not empty\");this.namespaces=t,this.optionalNamespaces=s,this.sessionProperties=n,this.persist(\"namespaces\",t),this.persist(\"optionalNamespaces\",s)}validateChain(e){const[t,s]=e?.split(\":\")||[\"\",\"\"];if(t&&!Object.keys(this.namespaces).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const n=Object.keys(this.namespaces)[0],r=this.rpcProviders[n].getDefaultChain();return[n,r]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){const[s,n]=this.validateChain(e);t||this.getProvider(s).setDefaultChain(n),this.namespaces[s].defaultChain=n,this.persist(\"namespaces\",this.namespaces),this.events.emit(\"chainChanged\",n)}onConnect(){this.createProviders(),this.events.emit(\"connect\",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${E}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${E}/${e}`)}}const pe=m;export{pe as UniversalProvider,m as default};\n//# sourceMappingURL=index.es.js.map\n"]},"metadata":{},"sourceType":"module"}