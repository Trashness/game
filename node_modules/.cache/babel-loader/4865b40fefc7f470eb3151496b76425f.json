{"ast":null,"code":"import _toConsumableArray from \"C:/Users/Kompa/Desktop/games/my-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _slicedToArray from \"C:/Users/Kompa/Desktop/games/my-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _regeneratorRuntime from \"C:/Users/Kompa/Desktop/games/my-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/Kompa/Desktop/games/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { providers } from 'ethers';\nimport { getAddress } from 'ethers/lib/utils';\nimport { createContext, useCallback, useContext, useEffect, useState } from 'react';\nimport { useConfig, useLocalStorage, useReadonlyNetwork } from '../../../hooks';\nimport { useReadonlyNetworkStates } from '../readonlyNetworks/context';\nimport { ConnectorController } from './connectorController';\nimport { InjectedConnector } from './implementations';\nvar Provider = providers.Provider;\nvar getAccount = function getAccount(connector) {\n  if (connector === null || connector === void 0 ? void 0 : connector.accounts[0]) {\n    return getAddress(connector.accounts[0]);\n  }\n  return undefined;\n};\nexport var ConnectorContext = createContext({\n  connector: undefined,\n  //eslint-disable-next-line @typescript-eslint/no-empty-function\n  activate: function () {\n    var _activate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }));\n    function activate() {\n      return _activate.apply(this, arguments);\n    }\n    return activate;\n  }(),\n  //eslint-disable-next-line @typescript-eslint/no-empty-function\n  deactivate: function deactivate() {},\n  //eslint-disable-next-line @typescript-eslint/no-empty-function\n  activateBrowserWallet: function activateBrowserWallet() {},\n  //eslint-disable-next-line @typescript-eslint/no-empty-function\n  reportError: function reportError() {},\n  isLoading: false,\n  setError: function setError() {\n    throw new Error('Function not implemented.');\n  },\n  active: false,\n  switchNetwork: function switchNetwork() {\n    throw new Error('Function not implemented.');\n  }\n});\nexport function ConnectorContextProvider(_ref) {\n  var children = _ref.children;\n  var _a;\n  var _useState = useState(),\n    _useState2 = _slicedToArray(_useState, 2),\n    controller = _useState2[0],\n    setController = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    isLoading = _useState4[0],\n    setLoading = _useState4[1];\n  var config = useConfig();\n  var connectors = config.connectors,\n    autoConnect = config.autoConnect;\n  var _useLocalStorage = useLocalStorage('usedapp:autoConnectTag'),\n    _useLocalStorage2 = _slicedToArray(_useLocalStorage, 2),\n    autoConnectTag = _useLocalStorage2[0],\n    setAutoConnectTag = _useLocalStorage2[1];\n  var activate = useCallback( /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(providerOrConnector) {\n      var _ref3,\n        silently,\n        onSuccess,\n        controller,\n        wrappedProvider,\n        _args2 = arguments;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n            _ref3 = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : {\n              silently: false\n            }, silently = _ref3.silently, onSuccess = _ref3.onSuccess;\n            if ('activate' in providerOrConnector) {\n              controller = new ConnectorController(providerOrConnector, config);\n            } else {\n              wrappedProvider = Provider.isProvider(providerOrConnector) ? providerOrConnector : new providers.Web3Provider(providerOrConnector);\n              controller = new ConnectorController(new InjectedConnector(wrappedProvider), config);\n            }\n            setLoading(true);\n            setController(controller);\n            _context2.prev = 4;\n            if (!silently) {\n              _context2.next = 10;\n              break;\n            }\n            _context2.next = 8;\n            return controller.activate(function (connector) {\n              return connector.connectEagerly();\n            });\n          case 8:\n            _context2.next = 12;\n            break;\n          case 10:\n            _context2.next = 12;\n            return controller.activate();\n          case 12:\n            setLoading(false);\n            onSuccess === null || onSuccess === void 0 ? void 0 : onSuccess();\n            _context2.next = 19;\n            break;\n          case 16:\n            _context2.prev = 16;\n            _context2.t0 = _context2[\"catch\"](4);\n            controller.reportError(_context2.t0);\n          case 19:\n            _context2.prev = 19;\n            setLoading(false);\n            return _context2.finish(19);\n          case 22:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2, null, [[4, 16, 19, 22]]);\n    }));\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(), [setController, setLoading]);\n  var activateBrowserWallet = useCallback( /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(options) {\n      var _options, type;\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) switch (_context3.prev = _context3.next) {\n          case 0:\n            // done for backward compatibility.\n            // If the options object looks like an event object or is undefined,\n            // it's not a valid option and will be ignored\n            if (!options || typeof options.preventDefault === 'function') {\n              options = {\n                type: 'metamask'\n              };\n            }\n            _options = options, type = _options.type;\n            if (connectors[type]) {\n              _context3.next = 4;\n              break;\n            }\n            throw new Error(\"Connector \".concat(type, \" is not configured\"));\n          case 4:\n            _context3.next = 6;\n            return activate(connectors[type], {\n              onSuccess: function onSuccess() {\n                setAutoConnectTag(type);\n              }\n            });\n          case 6:\n          case \"end\":\n            return _context3.stop();\n        }\n      }, _callee3);\n    }));\n    return function (_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }(), [activate, setAutoConnectTag, connectors]);\n  var deactivate = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n    return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n      while (1) switch (_context4.prev = _context4.next) {\n        case 0:\n          setAutoConnectTag(undefined);\n          setLoading(true);\n          setController(undefined);\n          _context4.next = 5;\n          return controller === null || controller === void 0 ? void 0 : controller.deactivate();\n        case 5:\n          setLoading(false);\n        case 6:\n        case \"end\":\n          return _context4.stop();\n      }\n    }, _callee4);\n  })), [controller]);\n  var reportError = useCallback(function (err) {\n    controller === null || controller === void 0 ? void 0 : controller.reportError(err);\n  }, [controller]);\n  var switchNetwork = useCallback( /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(chainId) {\n      return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n        while (1) switch (_context5.prev = _context5.next) {\n          case 0:\n            _context5.next = 2;\n            return controller === null || controller === void 0 ? void 0 : controller.switchNetwork(chainId);\n          case 2:\n          case \"end\":\n            return _context5.stop();\n        }\n      }, _callee5);\n    }));\n    return function (_x3) {\n      return _ref6.apply(this, arguments);\n    };\n  }(), [controller]);\n  var setErrorDeprecated = useCallback(function () {\n    throw new Error('setError is deprecated');\n  }, []);\n  var ethersActivate = useCallback( /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(providerOrConnector) {\n      return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n        while (1) switch (_context6.prev = _context6.next) {\n          case 0:\n            if (!('getProvider' in providerOrConnector)) {\n              _context6.next = 9;\n              break;\n            }\n            console.warn('Using web3-react connectors is deprecated and may lead to unexpected behavior.');\n            _context6.next = 4;\n            return providerOrConnector.activate();\n          case 4:\n            _context6.t0 = activate;\n            _context6.next = 7;\n            return providerOrConnector.getProvider();\n          case 7:\n            _context6.t1 = _context6.sent;\n            return _context6.abrupt(\"return\", (0, _context6.t0)(_context6.t1));\n          case 9:\n            return _context6.abrupt(\"return\", activate(providerOrConnector));\n          case 10:\n          case \"end\":\n            return _context6.stop();\n        }\n      }, _callee6);\n    }));\n    return function (_x4) {\n      return _ref7.apply(this, arguments);\n    };\n  }(), []);\n  useEffect(function () {\n    if (autoConnect && autoConnectTag && connectors[autoConnectTag]) {\n      void activate(connectors[autoConnectTag], {\n        silently: true\n      });\n    }\n  }, []);\n  useEffect(function () {\n    controller === null || controller === void 0 ? void 0 : controller.updateConfig(config);\n  }, [controller, config]);\n  var readonlyNetwork = useReadonlyNetwork();\n  var _useState5 = useState((_a = controller === null || controller === void 0 ? void 0 : controller.errors) !== null && _a !== void 0 ? _a : []),\n    _useState6 = _slicedToArray(_useState5, 2),\n    errors = _useState6[0],\n    setErrors = _useState6[1];\n  var _useState7 = useState(getAccount(controller)),\n    _useState8 = _slicedToArray(_useState7, 2),\n    account = _useState8[0],\n    setAccount = _useState8[1];\n  var _useState9 = useState(controller === null || controller === void 0 ? void 0 : controller.getProvider()),\n    _useState10 = _slicedToArray(_useState9, 2),\n    provider = _useState10[0],\n    setProvider = _useState10[1];\n  var _useState11 = useState(controller === null || controller === void 0 ? void 0 : controller.chainId),\n    _useState12 = _slicedToArray(_useState11, 2),\n    chainId = _useState12[0],\n    setChainId = _useState12[1];\n  useEffect(function () {\n    if (!(controller === null || controller === void 0 ? void 0 : controller.getProvider())) {\n      setAccount(undefined);\n      setProvider(readonlyNetwork === null || readonlyNetwork === void 0 ? void 0 : readonlyNetwork.provider);\n      setChainId(readonlyNetwork === null || readonlyNetwork === void 0 ? void 0 : readonlyNetwork.chainId);\n      setErrors([]);\n    } else {\n      setChainId(controller.chainId);\n      setErrors(controller.errors);\n      setProvider(controller.getProvider());\n      setAccount(getAccount(controller));\n    }\n    return controller === null || controller === void 0 ? void 0 : controller.updated.on(function (_ref8) {\n      var chainId = _ref8.chainId,\n        errors = _ref8.errors,\n        accounts = _ref8.accounts;\n      if (chainId) {\n        setChainId(chainId);\n        setProvider(controller.getProvider());\n        if (accounts[0]) {\n          setAccount(getAddress(accounts[0]));\n        } else {\n          setAccount(undefined);\n        }\n      }\n      setErrors(_toConsumableArray(errors));\n    });\n  }, [controller, controller === null || controller === void 0 ? void 0 : controller.getProvider()]);\n  var _useConfig = useConfig(),\n    networks = _useConfig.networks,\n    readOnlyUrls = _useConfig.readOnlyUrls;\n  var _useState13 = useState(undefined),\n    _useState14 = _slicedToArray(_useState13, 2),\n    error = _useState14[0],\n    setError = _useState14[1];\n  var networkStates = useReadonlyNetworkStates();\n  var configuredChainIds = Object.keys(readOnlyUrls || {}).map(function (chainId) {\n    return parseInt(chainId, 10);\n  });\n  var supportedChainIds = networks === null || networks === void 0 ? void 0 : networks.map(function (network) {\n    return network.chainId;\n  });\n  useEffect(function () {\n    var isNotConfiguredChainId = chainId && configuredChainIds && configuredChainIds.indexOf(chainId) < 0;\n    var isUnsupportedChainId = chainId && supportedChainIds && supportedChainIds.indexOf(chainId) < 0;\n    if (isUnsupportedChainId || isNotConfiguredChainId) {\n      var chainIdError = new Error(\"\".concat(isUnsupportedChainId ? 'Unsupported' : 'Not configured', \" chain id: \").concat(chainId, \".\"));\n      chainIdError.name = 'ChainIdError';\n      setError(chainIdError);\n      return;\n    }\n    for (var _i = 0, _Object$values = Object.values(networkStates); _i < _Object$values.length; _i++) {\n      var networkState = _Object$values[_i];\n      if (networkState.errors.length > 0) {\n        setError(networkState.errors[networkState.errors.length - 1]);\n        return;\n      }\n    }\n    setError(errors === null || errors === void 0 ? void 0 : errors[errors.length - 1]);\n  }, [chainId, errors, networkStates]);\n  return _jsx(ConnectorContext.Provider, Object.assign({\n    value: {\n      connector: controller,\n      deactivate: deactivate,\n      reportError: reportError,\n      activate: ethersActivate,\n      activateBrowserWallet: activateBrowserWallet,\n      isLoading: isLoading,\n      account: account,\n      library: provider,\n      chainId: (error === null || error === void 0 ? void 0 : error.name) === 'ChainIdError' ? undefined : provider !== undefined ? chainId : readonlyNetwork === null || readonlyNetwork === void 0 ? void 0 : readonlyNetwork.chainId,\n      error: error,\n      active: !!provider,\n      switchNetwork: switchNetwork,\n      setError: setErrorDeprecated\n    }\n  }, {\n    children: children\n  }));\n}\nexport var useConnector = function useConnector() {\n  return useContext(ConnectorContext);\n};","map":{"version":3,"sources":["../../../../../../src/providers/network/connectors/context.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { providers } from 'ethers';\nimport { getAddress } from 'ethers/lib/utils';\nimport { createContext, useCallback, useContext, useEffect, useState } from 'react';\nimport { useConfig, useLocalStorage, useReadonlyNetwork } from '../../../hooks';\nimport { useReadonlyNetworkStates } from '../readonlyNetworks/context';\nimport { ConnectorController } from './connectorController';\nimport { InjectedConnector } from './implementations';\nconst Provider = providers.Provider;\nconst getAccount = (connector) => {\n    if (connector === null || connector === void 0 ? void 0 : connector.accounts[0]) {\n        return getAddress(connector.accounts[0]);\n    }\n    return undefined;\n};\nexport const ConnectorContext = createContext({\n    connector: undefined,\n    //eslint-disable-next-line @typescript-eslint/no-empty-function\n    activate: async () => { },\n    //eslint-disable-next-line @typescript-eslint/no-empty-function\n    deactivate: () => { },\n    //eslint-disable-next-line @typescript-eslint/no-empty-function\n    activateBrowserWallet: () => { },\n    //eslint-disable-next-line @typescript-eslint/no-empty-function\n    reportError: () => { },\n    isLoading: false,\n    setError: () => {\n        throw new Error('Function not implemented.');\n    },\n    active: false,\n    switchNetwork: () => {\n        throw new Error('Function not implemented.');\n    },\n});\nexport function ConnectorContextProvider({ children }) {\n    var _a;\n    const [controller, setController] = useState();\n    const [isLoading, setLoading] = useState(false);\n    const config = useConfig();\n    const { connectors, autoConnect } = config;\n    const [autoConnectTag, setAutoConnectTag] = useLocalStorage('usedapp:autoConnectTag');\n    const activate = useCallback(async (providerOrConnector, { silently, onSuccess } = { silently: false }) => {\n        let controller;\n        if ('activate' in providerOrConnector) {\n            controller = new ConnectorController(providerOrConnector, config);\n        }\n        else {\n            const wrappedProvider = Provider.isProvider(providerOrConnector)\n                ? providerOrConnector\n                : new providers.Web3Provider(providerOrConnector);\n            controller = new ConnectorController(new InjectedConnector(wrappedProvider), config);\n        }\n        setLoading(true);\n        setController(controller);\n        try {\n            if (silently) {\n                await controller.activate((connector) => connector.connectEagerly());\n            }\n            else {\n                await controller.activate();\n            }\n            setLoading(false);\n            onSuccess === null || onSuccess === void 0 ? void 0 : onSuccess();\n        }\n        catch (error) {\n            controller.reportError(error);\n        }\n        finally {\n            setLoading(false);\n        }\n    }, [setController, setLoading]);\n    const activateBrowserWallet = useCallback(async (options) => {\n        // done for backward compatibility.\n        // If the options object looks like an event object or is undefined,\n        // it's not a valid option and will be ignored\n        if (!options || typeof options.preventDefault === 'function') {\n            options = { type: 'metamask' };\n        }\n        const { type } = options;\n        if (!connectors[type]) {\n            throw new Error(`Connector ${type} is not configured`);\n        }\n        await activate(connectors[type], {\n            onSuccess: () => {\n                setAutoConnectTag(type);\n            },\n        });\n    }, [activate, setAutoConnectTag, connectors]);\n    const deactivate = useCallback(async () => {\n        setAutoConnectTag(undefined);\n        setLoading(true);\n        setController(undefined);\n        await (controller === null || controller === void 0 ? void 0 : controller.deactivate());\n        setLoading(false);\n    }, [controller]);\n    const reportError = useCallback((err) => {\n        controller === null || controller === void 0 ? void 0 : controller.reportError(err);\n    }, [controller]);\n    const switchNetwork = useCallback(async (chainId) => {\n        await (controller === null || controller === void 0 ? void 0 : controller.switchNetwork(chainId));\n    }, [controller]);\n    const setErrorDeprecated = useCallback(() => {\n        throw new Error('setError is deprecated');\n    }, []);\n    const ethersActivate = useCallback(async (providerOrConnector) => {\n        if ('getProvider' in providerOrConnector) {\n            console.warn('Using web3-react connectors is deprecated and may lead to unexpected behavior.');\n            await providerOrConnector.activate();\n            return activate(await providerOrConnector.getProvider());\n        }\n        return activate(providerOrConnector);\n    }, []);\n    useEffect(() => {\n        if (autoConnect && autoConnectTag && connectors[autoConnectTag]) {\n            void activate(connectors[autoConnectTag], {\n                silently: true,\n            });\n        }\n    }, []);\n    useEffect(() => {\n        controller === null || controller === void 0 ? void 0 : controller.updateConfig(config);\n    }, [controller, config]);\n    const readonlyNetwork = useReadonlyNetwork();\n    const [errors, setErrors] = useState((_a = controller === null || controller === void 0 ? void 0 : controller.errors) !== null && _a !== void 0 ? _a : []);\n    const [account, setAccount] = useState(getAccount(controller));\n    const [provider, setProvider] = useState(controller === null || controller === void 0 ? void 0 : controller.getProvider());\n    const [chainId, setChainId] = useState(controller === null || controller === void 0 ? void 0 : controller.chainId);\n    useEffect(() => {\n        if (!(controller === null || controller === void 0 ? void 0 : controller.getProvider())) {\n            setAccount(undefined);\n            setProvider(readonlyNetwork === null || readonlyNetwork === void 0 ? void 0 : readonlyNetwork.provider);\n            setChainId(readonlyNetwork === null || readonlyNetwork === void 0 ? void 0 : readonlyNetwork.chainId);\n            setErrors([]);\n        }\n        else {\n            setChainId(controller.chainId);\n            setErrors(controller.errors);\n            setProvider(controller.getProvider());\n            setAccount(getAccount(controller));\n        }\n        return controller === null || controller === void 0 ? void 0 : controller.updated.on(({ chainId, errors, accounts }) => {\n            if (chainId) {\n                setChainId(chainId);\n                setProvider(controller.getProvider());\n                if (accounts[0]) {\n                    setAccount(getAddress(accounts[0]));\n                }\n                else {\n                    setAccount(undefined);\n                }\n            }\n            setErrors([...errors]);\n        });\n    }, [controller, controller === null || controller === void 0 ? void 0 : controller.getProvider()]);\n    const { networks, readOnlyUrls } = useConfig();\n    const [error, setError] = useState(undefined);\n    const networkStates = useReadonlyNetworkStates();\n    const configuredChainIds = Object.keys(readOnlyUrls || {}).map((chainId) => parseInt(chainId, 10));\n    const supportedChainIds = networks === null || networks === void 0 ? void 0 : networks.map((network) => network.chainId);\n    useEffect(() => {\n        const isNotConfiguredChainId = chainId && configuredChainIds && configuredChainIds.indexOf(chainId) < 0;\n        const isUnsupportedChainId = chainId && supportedChainIds && supportedChainIds.indexOf(chainId) < 0;\n        if (isUnsupportedChainId || isNotConfiguredChainId) {\n            const chainIdError = new Error(`${isUnsupportedChainId ? 'Unsupported' : 'Not configured'} chain id: ${chainId}.`);\n            chainIdError.name = 'ChainIdError';\n            setError(chainIdError);\n            return;\n        }\n        for (const networkState of Object.values(networkStates)) {\n            if (networkState.errors.length > 0) {\n                setError(networkState.errors[networkState.errors.length - 1]);\n                return;\n            }\n        }\n        setError(errors === null || errors === void 0 ? void 0 : errors[errors.length - 1]);\n    }, [chainId, errors, networkStates]);\n    return (_jsx(ConnectorContext.Provider, Object.assign({ value: {\n            connector: controller,\n            deactivate,\n            reportError,\n            activate: ethersActivate,\n            activateBrowserWallet,\n            isLoading,\n            account,\n            library: provider,\n            chainId: (error === null || error === void 0 ? void 0 : error.name) === 'ChainIdError' ? undefined : provider !== undefined ? chainId : readonlyNetwork === null || readonlyNetwork === void 0 ? void 0 : readonlyNetwork.chainId,\n            error,\n            active: !!provider,\n            switchNetwork,\n            setError: setErrorDeprecated,\n        } }, { children: children })));\n}\nexport const useConnector = () => useContext(ConnectorContext);\n//# sourceMappingURL=context.js.map"]},"metadata":{},"sourceType":"module"}